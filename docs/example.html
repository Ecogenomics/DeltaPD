

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Example &mdash; deltapd 0.1.0 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/theme_overrides.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="_static/deltapd.svg"/>
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script src="_static/custom.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-84847737-3"></script>
    <script>
        window.dataLayer = window.dataLayer || [];

        function gtag() {
            dataLayer.push(arguments);
        }

        gtag('js', new Date());

        gtag('config', 'UA-84847737-3');
    </script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Preface" href="methods/preface.html" />
    <link rel="prev" title="Arguments" href="cli.html" />

 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html">
          

          
            
            <img src="_static/deltapd.svg" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="announcements.html">Announcements</a></li>
<li class="toctree-l1"><a class="reference internal" href="installing.html">Installation</a></li>
</ul>
<p class="caption"><span class="caption-text">Running DeltaPD</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="cli.html">Arguments</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Example</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#input">Input</a></li>
<li class="toctree-l2"><a class="reference internal" href="#output">Output</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#html-report">HTML Report</a></li>
<li class="toctree-l3"><a class="reference internal" href="#plots">Plots</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#qtree">QTree</a></li>
<li class="toctree-l4"><a class="reference internal" href="#rtree">RTree</a></li>
<li class="toctree-l4"><a class="reference internal" href="#pd">PD</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Methods</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="methods/preface.html">Preface</a></li>
<li class="toctree-l1"><a class="reference internal" href="methods/overview.html">Overview</a></li>
</ul>
<p class="caption"><span class="caption-text">About</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Change log</a></li>
<li class="toctree-l1"><a class="reference internal" href="references.html">References</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">deltapd</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Example</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/Ecogenomics/DeltaPD/blob/master/docs_src/src/example.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="example">
<h1>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h1>
<div class="section" id="input">
<h2>Input<a class="headerlink" href="#input" title="Permalink to this headline">¶</a></h2>
<p>The files used in this example can be obtained from the <cite>example</cite> folder on the DeltaPD GitHub repository.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run DeltaPD on the example data (note, low value of k is for demonstration purposes)</span>
deltapd --r_tree ar122_reference.tree --q_tree ar122_ssu_query.tree --metadata ar122_metadata_r95.tsv --msa_file ar122_ssu_r95.fna --influence_thresh <span class="m">2</span> --diff_thresh <span class="m">0</span>.10 --out_dir /tmp/deltapd --k <span class="m">20</span> --cpus <span class="m">10</span> --plot
</pre></div>
</div>
</div>
<div class="section" id="output">
<h2>Output<a class="headerlink" href="#output" title="Permalink to this headline">¶</a></h2>
<p>DeltaPD will output two log files, two directories, and a HTML report:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">report_data</span></code> contains HTML assets used only for <code class="docutils literal notranslate"><span class="pre">report.html</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">deltapd_data</span></code> contains the raw data and images used in the HTML report. <code class="docutils literal notranslate"><span class="pre">model.tsv</span></code> contained within each iteration contains the full information presented in the report.</p></li>
</ul>
<div class="section" id="html-report">
<h3>HTML Report<a class="headerlink" href="#html-report" title="Permalink to this headline">¶</a></h3>
<p>The HTML report will contain each outlier identified in a table similar to the one below:</p>
<p><strong>Outlier:</strong> GB_GCA_002508555.1___DABX01000054.1</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 15%" />
<col style="width: 8%" />
<col style="width: 7%" />
<col style="width: 6%" />
<col style="width: 7%" />
<col style="width: 6%" />
<col style="width: 8%" />
<col style="width: 7%" />
<col style="width: 8%" />
<col style="width: 13%" />
<col style="width: 15%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Reference Taxon</p></th>
<th class="head"><p>Iteration</p></th>
<th class="head"><p>R2 Base</p></th>
<th class="head"><p>R2 JK</p></th>
<th class="head"><p>MSE Base</p></th>
<th class="head"><p>MSE JK</p></th>
<th class="head"><p>Grad Base</p></th>
<th class="head"><p>Grad JK</p></th>
<th class="head"><p>Influence</p></th>
<th class="head"><p>Delta from base</p></th>
<th class="head"><p>Plots</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>GB_GCA_013331315.1</p></td>
<td><p>0</p></td>
<td><p>0.7313</p></td>
<td><p>0.8494</p></td>
<td><p>0.5184</p></td>
<td><p>0.388</p></td>
<td><p>1.2313</p></td>
<td><p>1.2159</p></td>
<td><p>4.5407</p></td>
<td><p>0.1304</p></td>
<td><p>QTree / RTree / PD</p></td>
</tr>
<tr class="row-odd"><td><p>GB_GCA_001595885.1</p></td>
<td><p>0</p></td>
<td><p>0.7445</p></td>
<td><p>0.855</p></td>
<td><p>0.5055</p></td>
<td><p>0.3807</p></td>
<td><p>1.2367</p></td>
<td><p>1.2201</p></td>
<td><p>4.4951</p></td>
<td><p>0.1247</p></td>
<td><p>QTree / RTree / PD</p></td>
</tr>
</tbody>
</table>
<p><strong>Reference Taxon:</strong>
The query taxon (GB_GCA_002508555.1___DABX01000054.1) has appeared in the <code class="docutils literal notranslate"><span class="pre">k=20</span></code> nearest neighbours for both reference taxa (GB_GCA_013331315.1, GB_GCA_001595885.1).</p>
<p><strong>Iteration:</strong></p>
<p>DeltaPD iteratively removes outliers until no outliers can be detected, this is to reduce the effect of masking (i.e. very high influence outliers will hide outliers with a smaller influence).</p>
<p><strong>Base/JK Columns:</strong></p>
<p>These are the respective metrics for the base set (i.e. all query and reference genomes for the <code class="docutils literal notranslate"><span class="pre">k=20</span></code> set), and the jackknifed set (JK). The jackknife set effectively
measures the impact of removing the query taxon from the set.</p>
<p><strong>Influence:</strong></p>
<p>This is the relative influence of the query taxon on the <code class="docutils literal notranslate"><span class="pre">k=20</span></code> set of taxa. Values higher than 2 should be considered outliers.</p>
<p><strong>Delta from base:</strong></p>
<p>This is the absolute difference between the mean squared error of the base and jackknife sets. This value can be used to threshold outliers, e.g.
outliers must cause at least a <code class="docutils literal notranslate"><span class="pre">0.1</span></code> difference in MSE.</p>
<p><strong>Plots:</strong></p>
<p>This contains plots for the query and reference trees (QTree, RTree) and the phylogenetic distance (PD). See below for more detail.</p>
</div>
<div class="section" id="plots">
<h3>Plots<a class="headerlink" href="#plots" title="Permalink to this headline">¶</a></h3>
<p>The following plots are those generated in the example above for reference taxon GB_GCA_013331315.1.</p>
<div class="section" id="qtree">
<h4>QTree<a class="headerlink" href="#qtree" title="Permalink to this headline">¶</a></h4>
<p>The columns pictured to the right of the plot are influence/delta (e.g. i/d [4.5407/1.304] respectively) and the contig length (e.g. 52,974).</p>
<p>Taxa that are identified as outliers in these plots will be marked with three asterisks.
Note that the influence value is considered to be absolute when determining if it exceeds the threshold.</p>
<a class="reference internal image-reference" href="_images/qtree.png"><img alt="QTree" class="align-center" src="_images/qtree.png" style="width: 50%;" /></a>
</div>
<div class="section" id="rtree">
<h4>RTree<a class="headerlink" href="#rtree" title="Permalink to this headline">¶</a></h4>
<p>When comparing the query tree against the reference tree, we can see that GB_GCA_002508555.1___DABX01000054.1 may be an outlier
as it is placed somewhat further away than expected from the other g__DTU008 taxa.</p>
<a class="reference internal image-reference" href="_images/rtree.png"><img alt="RTree" class="align-center" src="_images/rtree.png" style="width: 50%;" /></a>
</div>
<div class="section" id="pd">
<h4>PD<a class="headerlink" href="#pd" title="Permalink to this headline">¶</a></h4>
<p>The left plot is the base model (i.e. all taxa considered), and the right plot is the model without the outlier taxon (i.e. GB_GCA_002508555.1___DABX01000054.1).</p>
<p>The orange crosses (X) indicate all points that the outlier taxon is involved in. The X axis is the distance in the reference tree, and the Y axis is the distance in the query tree.
For example, the distance from A -&gt; B in the reference tree is 0.1, and the distance from A___1 to B___1 in the query tree is 0.9, therefore a point will be added at <code class="docutils literal notranslate"><span class="pre">(x,y)</span> <span class="pre">=</span> <span class="pre">(0.1,</span> <span class="pre">0.9)</span></code>.</p>
<p>We expect values to follow the <code class="docutils literal notranslate"><span class="pre">y=x</span></code> line in this plot, i.e. the distance is the same in the query and reference trees. However, in practice the gradient is rarely 1 but the linear trend is still observed.
It is typical of outliers that are misplaced to follow an “elbow” shape as pictured below, whereas outliers on very long branches will just appear as a distant cluster.</p>
<p>Using the image below we can identify that GB_GCA_002508555.1___DABX01000054.1 is an outlier as it visually appears misplaced in the tree, and follows the distinct elbow shape.</p>
<a class="reference internal image-reference" href="_images/pd.png"><img alt="PD" class="align-center" src="_images/pd.png" style="width: 50%;" /></a>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="methods/preface.html" class="btn btn-neutral float-right" title="Preface" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="cli.html" class="btn btn-neutral float-left" title="Arguments" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Aaron Mussig, DOI: 10.5281/zenodo.4107213

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>